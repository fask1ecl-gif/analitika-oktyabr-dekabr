<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Аналитика бронирований 15.10-14.12.2025</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100">
    <div class="min-h-screen p-8">
        <div class="max-w-7xl mx-auto">
            <div class="bg-white rounded-2xl shadow-2xl overflow-hidden">
                <!-- Шапка -->
                <div class="bg-gradient-to-r from-blue-600 to-indigo-600 p-8 text-white">
                    <h1 class="text-4xl font-bold mb-2">Аналитика бронирований</h1>
                    <p class="text-blue-100">Период: 15.10.2025 - 14.12.2025 (2 месяца)</p>
                </div>

                <!-- Навигация -->
                <div class="flex border-b">
                    <button onclick="showTab('summary')" id="tab-summary" class="flex-1 px-6 py-4 font-semibold transition-colors bg-blue-50 text-blue-600 border-b-2 border-blue-600">
                        Общая сводка
                    </button>
                    <button onclick="showTab('managers')" id="tab-managers" class="flex-1 px-6 py-4 font-semibold transition-colors text-gray-600 hover:bg-gray-50">
                        По менеджерам
                    </button>
                    <button onclick="showTab('sources')" id="tab-sources" class="flex-1 px-6 py-4 font-semibold transition-colors text-gray-600 hover:bg-gray-50">
                        По источникам
                    </button>
                </div>

                <!-- Содержимое -->
                <div class="p-8">
                    <!-- Общая сводка -->
                    <div id="content-summary">
                        <h2 class="text-3xl font-bold mb-6 text-gray-800">Общая статистика</h2>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                            <div class="bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl p-6 text-white shadow-lg">
                                <div class="text-blue-100 text-sm font-semibold mb-2">Всего броней</div>
                                <div class="text-4xl font-bold">595</div>
                            </div>
                            
                            <div class="bg-gradient-to-br from-red-500 to-red-600 rounded-xl p-6 text-white shadow-lg">
                                <div class="text-red-100 text-sm font-semibold mb-2">Отменено</div>
                                <div class="text-4xl font-bold">42</div>
                                <div class="text-red-100 text-xs mt-1">7.1%</div>
                            </div>
                            
                            <div class="bg-gradient-to-br from-orange-500 to-orange-600 rounded-xl p-6 text-white shadow-lg">
                                <div class="text-orange-100 text-sm font-semibold mb-2">Накрученные</div>
                                <div class="text-4xl font-bold">115</div>
                                <div class="text-orange-100 text-xs mt-1">Оценка за 2 месяца</div>
                            </div>
                            
                            <div class="bg-gradient-to-br from-green-500 to-green-600 rounded-xl p-6 text-white shadow-lg">
                                <div class="text-green-100 text-sm font-semibold mb-2">Реальные брони</div>
                                <div class="text-4xl font-bold">438</div>
                                <div class="text-green-100 text-xs mt-1">После корректировок</div>
                            </div>
                        </div>

                        <div class="bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl p-8 text-white shadow-lg mb-8">
                            <h3 class="text-2xl font-bold mb-4">Опросы</h3>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                <div>
                                    <div class="text-indigo-100 text-sm mb-2">Прошли опрос</div>
                                    <div class="text-5xl font-bold">27</div>
                                </div>
                                <div>
                                    <div class="text-indigo-100 text-sm mb-2">Процент прохождения</div>
                                    <div class="text-5xl font-bold">6.16%</div>
                                </div>
                                <div>
                                    <div class="text-indigo-100 text-sm mb-2">Не прошли</div>
                                    <div class="text-5xl font-bold">411</div>
                                </div>
                            </div>
                        </div>

                        <div class="bg-gray-50 rounded-xl p-6">
                            <h3 class="text-xl font-bold mb-4 text-gray-800">Методика расчета</h3>
                            <div class="space-y-2 text-gray-700">
                                <p>✓ Общее количество броней: 595</p>
                                <p>✓ Минус отмененные брони: -42 = 553</p>
                                <p>✓ Минус накрученные отзывы (оценка): -115 = 438</p>
                                <p>✓ Прошли опрос: 27 из 438 (6.16%)</p>
                            </div>
                        </div>
                    </div>

                    <!-- По менеджерам -->
                    <div id="content-managers" style="display:none;">
                        <h2 class="text-3xl font-bold mb-6 text-gray-800">Статистика по менеджерам</h2>
                        
                        <div class="mb-8">
                            <canvas id="managersChart" style="max-height: 400px;"></canvas>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <!-- Алмаз -->
                            <div class="bg-white border-2 border-gray-200 rounded-xl p-6 shadow-lg hover:shadow-xl transition-shadow">
                                <h3 class="text-2xl font-bold mb-4 text-gray-800">Алмаз</h3>
                                <div class="space-y-3">
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Всего броней:</span>
                                        <span class="font-bold text-blue-600">195</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Отменено:</span>
                                        <span class="font-bold text-red-600">19</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Валидных:</span>
                                        <span class="font-bold">176</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Накрученные (оценка):</span>
                                        <span class="font-bold text-orange-600">37</span>
                                    </div>
                                    <div class="flex justify-between border-t pt-3">
                                        <span class="text-gray-600 font-semibold">Реальные брони:</span>
                                        <span class="font-bold text-green-600 text-lg">139</span>
                                    </div>
                                    <div class="flex justify-between bg-indigo-50 -mx-6 -mb-6 p-6 rounded-b-xl mt-4">
                                        <span class="text-gray-700 font-semibold">Прошли опрос (оценка):</span>
                                        <div class="text-right">
                                            <div class="font-bold text-indigo-600 text-lg">9</div>
                                            <div class="text-sm text-indigo-500">6.47%</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Ксения -->
                            <div class="bg-white border-2 border-gray-200 rounded-xl p-6 shadow-lg hover:shadow-xl transition-shadow">
                                <h3 class="text-2xl font-bold mb-4 text-gray-800">Ксения</h3>
                                <div class="space-y-3">
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Всего броней:</span>
                                        <span class="font-bold text-blue-600">125</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Отменено:</span>
                                        <span class="font-bold text-red-600">3</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Валидных:</span>
                                        <span class="font-bold">122</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Накрученные (оценка):</span>
                                        <span class="font-bold text-orange-600">25</span>
                                    </div>
                                    <div class="flex justify-between border-t pt-3">
                                        <span class="text-gray-600 font-semibold">Реальные брони:</span>
                                        <span class="font-bold text-green-600 text-lg">97</span>
                                    </div>
                                    <div class="flex justify-between bg-indigo-50 -mx-6 -mb-6 p-6 rounded-b-xl mt-4">
                                        <span class="text-gray-700 font-semibold">Прошли опрос (оценка):</span>
                                        <div class="text-right">
                                            <div class="font-bold text-indigo-600 text-lg">6</div>
                                            <div class="text-sm text-indigo-500">6.19%</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Альберт -->
                            <div class="bg-white border-2 border-gray-200 rounded-xl p-6 shadow-lg hover:shadow-xl transition-shadow">
                                <h3 class="text-2xl font-bold mb-4 text-gray-800">Альберт</h3>
                                <div class="space-y-3">
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Всего броней:</span>
                                        <span class="font-bold text-blue-600">275</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Отменено:</span>
                                        <span class="font-bold text-red-600">20</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Валидных:</span>
                                        <span class="font-bold">255</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Накрученные (оценка):</span>
                                        <span class="font-bold text-orange-600">53</span>
                                    </div>
                                    <div class="flex justify-between border-t pt-3">
                                        <span class="text-gray-600 font-semibold">Реальные брони:</span>
                                        <span class="font-bold text-green-600 text-lg">202</span>
                                    </div>
                                    <div class="flex justify-between bg-indigo-50 -mx-6 -mb-6 p-6 rounded-b-xl mt-4">
                                        <span class="text-gray-700 font-semibold">Прошли опрос (оценка):</span>
                                        <div class="text-right">
                                            <div class="font-bold text-indigo-600 text-lg">12</div>
                                            <div class="text-sm text-indigo-500">5.94%</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- По источникам -->
                    <div id="content-sources" style="display:none;">
                        <h2 class="text-3xl font-bold mb-6 text-gray-800">Статистика по источникам</h2>
                        
                        <div class="mb-8">
                            <canvas id="sourcesChart" style="max-height: 400px;"></canvas>
                        </div>

                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead>
                                    <tr class="bg-gray-100">
                                        <th class="px-6 py-3 text-left text-sm font-semibold text-gray-700">Источник</th>
                                        <th class="px-6 py-3 text-center text-sm font-semibold text-gray-700">Всего броней</th>
                                        <th class="px-6 py-3 text-center text-sm font-semibold text-gray-700">Отменено</th>
                                        <th class="px-6 py-3 text-center text-sm font-semibold text-gray-700">Валидных</th>
                                        <th class="px-6 py-3 text-center text-sm font-semibold text-gray-700">% отмен</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="bg-white">
                                        <td class="px-6 py-4 font-semibold text-gray-800">Avito.ru</td>
                                        <td class="px-6 py-4 text-center text-blue-600 font-bold">228</td>
                                        <td class="px-6 py-4 text-center text-red-600 font-bold">12</td>
                                        <td class="px-6 py-4 text-center text-green-600 font-bold">216</td>
                                        <td class="px-6 py-4 text-center text-gray-700">5.26%</td>
                                    </tr>
                                    <tr class="bg-gray-50">
                                        <td class="px-6 py-4 font-semibold text-gray-800">Sutochno.ru</td>
                                        <td class="px-6 py-4 text-center text-blue-600 font-bold">113</td>
                                        <td class="px-6 py-4 text-center text-red-600 font-bold">15</td>
                                        <td class="px-6 py-4 text-center text-green-600 font-bold">98</td>
                                        <td class="px-6 py-4 text-center text-gray-700">13.27%</td>
                                    </tr>
                                    <tr class="bg-white">
                                        <td class="px-6 py-4 font-semibold text-gray-800">Ostrovok.ru</td>
                                        <td class="px-6 py-4 text-center text-blue-600 font-bold">97</td>
                                        <td class="px-6 py-4 text-center text-red-600 font-bold">6</td>
                                        <td class="px-6 py-4 text-center text-green-600 font-bold">91</td>
                                        <td class="px-6 py-4 text-center text-gray-700">6.19%</td>
                                    </tr>
                                    <tr class="bg-gray-50">
                                        <td class="px-6 py-4 font-semibold text-gray-800">Яндекс Путешествия</td>
                                        <td class="px-6 py-4 text-center text-blue-600 font-bold">50</td>
                                        <td class="px-6 py-4 text-center text-red-600 font-bold">7</td>
                                        <td class="px-6 py-4 text-center text-green-600 font-bold">43</td>
                                        <td class="px-6 py-4 text-center text-gray-700">14.00%</td>
                                    </tr>
                                    <tr class="bg-white">
                                        <td class="px-6 py-4 font-semibold text-gray-800">Неизвестно</td>
                                        <td class="px-6 py-4 text-center text-blue-600 font-bold">42</td>
                                        <td class="px-6 py-4 text-center text-red-600 font-bold">0</td>
                                        <td class="px-6 py-4 text-center text-green-600 font-bold">42</td>
                                        <td class="px-6 py-4 text-center text-gray-700">0.00%</td>
                                    </tr>
                                    <tr class="bg-gray-50">
                                        <td class="px-6 py-4 font-semibold text-gray-800">Корзина</td>
                                        <td class="px-6 py-4 text-center text-blue-600 font-bold">22</td>
                                        <td class="px-6 py-4 text-center text-red-600 font-bold">0</td>
                                        <td class="px-6 py-4 text-center text-green-600 font-bold">22</td>
                                        <td class="px-6 py-4 text-center text-gray-700">0.00%</td>
                                    </tr>
                                    <tr class="bg-white">
                                        <td class="px-6 py-4 font-semibold text-gray-800">cian.ru</td>
                                        <td class="px-6 py-4 text-center text-blue-600 font-bold">13</td>
                                        <td class="px-6 py-4 text-center text-red-600 font-bold">1</td>
                                        <td class="px-6 py-4 text-center text-green-600 font-bold">12</td>
                                        <td class="px-6 py-4 text-center text-gray-700">7.69%</td>
                                    </tr>
                                    <tr class="bg-gray-50">
                                        <td class="px-6 py-4 font-semibold text-gray-800">Отелло</td>
                                        <td class="px-6 py-4 text-center text-blue-600 font-bold">8</td>
                                        <td class="px-6 py-4 text-center text-red-600 font-bold">0</td>
                                        <td class="px-6 py-4 text-center text-green-600 font-bold">8</td>
                                        <td class="px-6 py-4 text-center text-gray-700">0.00%</td>
                                    </tr>
                                    <tr class="bg-white">
                                        <td class="px-6 py-4 font-semibold text-gray-800">Bronevik.com</td>
                                        <td class="px-6 py-4 text-center text-blue-600 font-bold">7</td>
                                        <td class="px-6 py-4 text-center text-red-600 font-bold">1</td>
                                        <td class="px-6 py-4 text-center text-green-600 font-bold">6</td>
                                        <td class="px-6 py-4 text-center text-gray-700">14.29%</td>
                                    </tr>
                                    <tr class="bg-gray-50">
                                        <td class="px-6 py-4 font-semibold text-gray-800">Модуль бронирования</td>
                                        <td class="px-6 py-4 text-center text-blue-600 font-bold">5</td>
                                        <td class="px-6 py-4 text-center text-red-600 font-bold">0</td>
                                        <td class="px-6 py-4 text-center text-green-600 font-bold">5</td>
                                        <td class="px-6 py-4 text-center text-gray-700">0.00%</td>
                                    </tr>
                                    <tr class="bg-white">
                                        <td class="px-6 py-4 font-semibold text-gray-800">OneTwoTrip.com</td>
                                        <td class="px-6 py-4 text-center text-blue-600 font-bold">4</td>
                                        <td class="px-6 py-4 text-center text-red-600 font-bold">0</td>
                                        <td class="px-6 py-4 text-center text-green-600 font-bold">4</td>
                                        <td class="px-6 py-4 text-center text-gray-700">0.00%</td>
                                    </tr>
                                    <tr class="bg-gray-50">
                                        <td class="px-6 py-4 font-semibold text-gray-800">Tvil.ru</td>
                                        <td class="px-6 py-4 text-center text-blue-600 font-bold">3</td>
                                        <td class="px-6 py-4 text-center text-red-600 font-bold">0</td>
                                        <td class="px-6 py-4 text-center text-green-600 font-bold">3</td>
                                        <td class="px-6 py-4 text-center text-gray-700">0.00%</td>
                                    </tr>
                                    <tr class="bg-white">
                                        <td class="px-6 py-4 font-semibold text-gray-800">Постоянный гость</td>
                                        <td class="px-6 py-4 text-center text-blue-600 font-bold">3</td>
                                        <td class="px-6 py-4 text-center text-red-600 font-bold">0</td>
                                        <td class="px-6 py-4 text-center text-green-600 font-bold">3</td>
                                        <td class="px-6 py-4 text-center text-gray-700">0.00%</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let managersChart = null;
        let sourcesChart = null;

        function showTab(tabName) {
            // Скрыть все вкладки
            document.getElementById('content-summary').style.display = 'none';
            document.getElementById('content-managers').style.display = 'none';
            document.getElementById('content-sources').style.display = 'none';

            // Убрать активный класс у всех кнопок
            document.getElementById('tab-summary').className = 'flex-1 px-6 py-4 font-semibold transition-colors text-gray-600 hover:bg-gray-50';
            document.getElementById('tab-managers').className = 'flex-1 px-6 py-4 font-semibold transition-colors text-gray-600 hover:bg-gray-50';
            document.getElementById('tab-sources').className = 'flex-1 px-6 py-4 font-semibold transition-colors text-gray-600 hover:bg-gray-50';

            // Показать выбранную вкладку
            document.getElementById('content-' + tabName).style.display = 'block';
            document.getElementById('tab-' + tabName).className = 'flex-1 px-6 py-4 font-semibold transition-colors bg-blue-50 text-blue-600 border-b-2 border-blue-600';

            // Создать графики при необходимости
            if (tabName === 'managers' && !managersChart) {
                createManagersChart();
            }
            if (tabName === 'sources' && !sourcesChart) {
                createSourcesChart();
            }
        }

        function createManagersChart() {
            const ctx = document.getElementById('managersChart');
            managersChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Алмаз', 'Ксения', 'Альберт'],
                    datasets: [
                        {
                            label: 'Всего броней',
                            data: [195, 125, 275],
                            backgroundColor: '#3B82F6'
                        },
                        {
                            label: 'Отменено',
                            data: [19, 3, 20],
                            backgroundColor: '#EF4444'
                        },
                        {
                            label: 'Реальные брони',
                            data: [139, 97, 202],
                            backgroundColor: '#10B981'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        function createSourcesChart() {
            const ctx = document.getElementById('sourcesChart');
            sourcesChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['Avito.ru', 'Sutochno.ru', 'Ostrovok.ru', 'Яндекс Путешествия', 'Неизвестно', 'Корзина', 'Другие'],
                    datasets: [{
                        data: [216, 98, 91, 43, 42, 22, 41],
                        backgroundColor: [
                            '#0088FE',
                            '#00C49F',
                            '#FFBB28',
                            '#FF8042',
                            '#8884D8',
                            '#82CA9D',
                            '#FFC658'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }
    </script>
</body>
</html>